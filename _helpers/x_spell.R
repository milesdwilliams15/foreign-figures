# -------------------------------------------------------------------------
# x_spell()
# -------------------------------------------------------------------------

x_spell <- function(x) {
  nx <- 1 - x
  for(i in 1:length(x)) {
    if(i == 1) {
      nx[i] <- nx[i]
    } else {
      nx[i] <- (nx[i] + nx[i - 1]) * (1 - x[i])
    }
  }
  ifelse(nx > 0, nx - 1, nx)
}
